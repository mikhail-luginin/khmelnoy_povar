{% extends 'base.html' %}

{% block title %}FAQ{% endblock %}
{% block page_title %}FAQ{% endblock %}

{% block body %}
    <div class="container-xl">
        <div class="card rounded-3">
            <div class="card-header card-header-light rounded-top-3">
                <h3 class="card-title">FAQ</h3>
                <div class="card-actions"></div>
                    <a href="{% url 'LK:create_faq' %}" class="btn btn-tabler">Создать запись</a>
                </div>
            </div>
            <div class="card-body">
                <div id="faq_accordion" class="accordion">
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        $(document).ready(function () {
            $.ajax({
                data: $(this).serialize(),
                url: '/api/faq',
                type: 'get',
                success: function (response) {
                    let faq = $('#faq_accordion')
                    faq.html('')
                    response.forEach(function (row) {
                        faq.append(
                            '<div class="accordion-item">' +
                            '<h2 class="accordion-header">' +

                            '<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"' +
                            'data-bs-target="#item_' + row['id'] + '" aria-expanded="false">' + row['title'] +
                            '</button></h2>' +
                            '<div id="item_' + row['id'] + '" class="accordion-collapse collapse" ' +
                            'data-bs-parent="#faq_accordion" style="">' +
                            '<div class="accordion-body pt-0">' + row['body'] +
                            '<br><a href="faq/edit?id=' + row['id'] + '"<i class="fa fa-edit"></a>'+
                            '<a href="#" onclick="delete_confirm(' + '\'' + row['id'] + '\'' + ', ' +
                            '\'Вы действительно хотите удалить данную запись?\'' + ', ' + '\'faq/delete' +
                            '\'' + ')"><i class="fa fa-trash"></i></a>' +
                            '</div></div></div>'
                        )
                    })
                }
            })
        })
    </script>
{% endblock %}